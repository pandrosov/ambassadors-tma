# Ambassadors TMA - –°–µ—Ä–≤–∏—Å –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –∞–º–±–∞—Å—Å–∞–¥–æ—Ä–Ω—ã—Ö –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π

## –û–ø–∏—Å–∞–Ω–∏–µ

–°–µ—Ä–≤–∏—Å –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –∏–Ω—Ñ–ª—é–µ–Ω—Å-–º–∞—Ä–∫–µ—Ç–∏–Ω–≥–∞ –≤ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –∞–º–±–∞—Å—Å–∞–¥–æ—Ä–Ω—ã—Ö –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π —á–µ—Ä–µ–∑ Telegram Mini App. –ó–∞–º–µ–Ω—è–µ—Ç —Ä—É—á–Ω—É—é —Ä–∞–±–æ—Ç—É —Å ManyChat –∏ Google Sheets –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º —Ä–µ—à–µ–Ω–∏–µ–º.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

- **Backend**: Node.js + TypeScript + Express
- **Frontend**: React + TypeScript + Vite (Telegram Mini App)
- **Database**: PostgreSQL + Prisma ORM
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏**: Telegram Bot API, Google Sheets API

## –û—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

1. ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–º–±–∞—Å—Å–∞–¥–æ—Ä–∞–º–∏
2. ‚úÖ –°–∏—Å—Ç–µ–º–∞ –∑–∞–¥–∞–Ω–∏–π (–æ–±—â–∏–µ –¥–ª—è –≤—Å–µ—Ö –∏ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ)
3. ‚úÖ –°–∏—Å—Ç–µ–º–∞ –æ—Ç—á–µ—Ç–æ–≤ (—Å—Å—ã–ª–∫–∏ –Ω–∞ —Ä–æ–ª–∏–∫–∏, —Å–∫—Ä–∏–Ω—à–æ—Ç—ã –æ—Ö–≤–∞—Ç–æ–≤)
4. ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å Google Sheets
5. ‚úÖ –ü–∞—Ä—Å–µ—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Å–æ—Ü—Å–µ—Ç–µ–π (YouTube, Instagram, TikTok)
6. ‚úÖ –°–∏—Å—Ç–µ–º–∞ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è —Ñ–ª–∞—Ä–∏–∫–æ–≤ (–∫–æ–π–Ω–æ–≤)
7. ‚úÖ –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –æ–± –æ—Ç—á–µ—Ç–∞—Ö (–∫–∞–∂–¥—É—é –ø—è—Ç–Ω–∏—Ü—É)
8. ‚úÖ –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ (–∫–∞–∂–¥–æ–µ –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ)

## üöÄ –î–µ–ø–ª–æ–π

–î–ª—è –¥–µ–ø–ª–æ—è –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã —Å–º. [DEPLOYMENT.md](./DEPLOYMENT.md)

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã:**
- **Railway** - –¥–ª—è full-stack –¥–µ–ø–ª–æ—è (backend + PostgreSQL)
- **Vercel** - –¥–ª—è frontend (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- **Supabase/Neon** - –¥–ª—è PostgreSQL (–µ—Å–ª–∏ –¥–µ–ø–ª–æ–∏—Ç–µ –æ—Ç–¥–µ–ª—å–Ω–æ)

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
ambassadors_tma/
‚îú‚îÄ‚îÄ backend/              # Backend API —Å–µ—Ä–≤–µ—Ä
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ routes/       # API —Ä–æ—É—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ services/     # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ middleware/   # Middleware
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ cron/         # –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ lib/          # –£—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ prisma/           # –°—Ö–µ–º–∞ –ë–î
‚îú‚îÄ‚îÄ frontend/             # Telegram Mini App
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pages/        # –°—Ç—Ä–∞–Ω–∏—Ü—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ components/   # –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ lib/          # –£—Ç–∏–ª–∏—Ç—ã –∏ API
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ store/        # State management
‚îî‚îÄ‚îÄ shared/               # –û–±—â–∏–µ —Ç–∏–ø—ã –∏ —É—Ç–∏–ª–∏—Ç—ã
```

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Node.js 18+
- PostgreSQL 14+
- Telegram Bot Token
- Google Sheets API credentials (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
# –í –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞
npm install

# –ò–ª–∏ –æ—Ç–¥–µ–ª—å–Ω–æ
cd backend && npm install
cd ../frontend && npm install
cd ../shared && npm install
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```bash
cd backend

# –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª .env –Ω–∞ –æ—Å–Ω–æ–≤–µ .env.example
cp .env.example .env

# –ó–∞–ø–æ–ª–Ω–∏—Ç–µ DATABASE_URL –≤ .env
# –ü—Ä–∏–º–µ—Ä: DATABASE_URL="postgresql://user:password@localhost:5432/ambassadors_tma?schema=public"

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏
npm run prisma:migrate

# –°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ Prisma Client
npm run prisma:generate
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

#### Backend (.env)
```env
DATABASE_URL="postgresql://..."
PORT=3000
NODE_ENV=development

TELEGRAM_BOT_TOKEN=your_bot_token
TELEGRAM_WEBHOOK_URL=https://your-domain.com/webhook

GOOGLE_SHEETS_CLIENT_ID=your_client_id
GOOGLE_SHEETS_CLIENT_SECRET=your_client_secret
GOOGLE_SHEETS_REDIRECT_URI=https://your-domain.com/auth/google/callback
GOOGLE_SHEETS_REFRESH_TOKEN=your_refresh_token
GOOGLE_SHEETS_SPREADSHEET_ID=your_spreadsheet_id

JWT_SECRET=your_jwt_secret
FRONTEND_URL=https://your-miniapp-url.com
```

#### Frontend (.env)
```env
VITE_API_URL=http://localhost:3000
```

### 4. –ó–∞–ø—É—Å–∫ –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

```bash
# –ò–∑ –∫–æ—Ä–Ω—è –ø—Ä–æ–µ–∫—Ç–∞ (–∑–∞–ø—É—Å–∫–∞–µ—Ç –æ–±–∞ —Å–µ—Ä–≤–µ—Ä–∞)
npm run dev

# –ò–ª–∏ –æ—Ç–¥–µ–ª—å–Ω–æ:
# Backend
cd backend
npm run dev

# Frontend (–≤ –¥—Ä—É–≥–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ)
cd frontend
npm run dev
```

### 5. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram Bot

1. –°–æ–∑–¥–∞–π—Ç–µ –±–æ—Ç–∞ —á–µ—Ä–µ–∑ [@BotFather](https://t.me/botfather)
2. –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –∏ –¥–æ–±–∞–≤—å—Ç–µ –≤ `.env`
3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Web App —á–µ—Ä–µ–∑ BotFather:
   ```
   /newapp
   [–≤—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à–µ–≥–æ –±–æ—Ç–∞]
   [–Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è]
   [—Å—Å—ã–ª–∫–∞ –Ω–∞ –≤–∞—à frontend]
   ```

## API Endpoints

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
- `GET /api/users/me` - –ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `PATCH /api/users/me` - –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å
- `GET /api/users/me/flariki` - –ò—Å—Ç–æ—Ä–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π —Ñ–ª–∞—Ä–∏–∫–æ–≤

### –ó–∞–¥–∞–Ω–∏—è
- `GET /api/tasks/me` - –ü–æ–ª—É—á–∏—Ç—å –∑–∞–¥–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `GET /api/tasks/:id` - –ü–æ–ª—É—á–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ
- `POST /api/tasks` - –°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞–Ω–∏–µ (MANAGER/ADMIN)
- `PATCH /api/tasks/:id` - –û–±–Ω–æ–≤–∏—Ç—å –∑–∞–¥–∞–Ω–∏–µ (MANAGER/ADMIN)

### –û—Ç—á–µ—Ç—ã
- `GET /api/reports/me` - –ü–æ–ª—É—á–∏—Ç—å –æ—Ç—á–µ—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `POST /api/reports` - –°–æ–∑–¥–∞—Ç—å –æ—Ç—á–µ—Ç
- `GET /api/reports/:id` - –ü–æ–ª—É—á–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –æ—Ç—á–µ—Ç
- `PATCH /api/reports/:id` - –û–±–Ω–æ–≤–∏—Ç—å –æ—Ç—á–µ—Ç (MANAGER/ADMIN)

### –§–ª–∞—Ä–∏–∫–∏
- `GET /api/flariki/balance` - –ü–æ–ª—É—á–∏—Ç—å –±–∞–ª–∞–Ω—Å
- `GET /api/flariki/transactions` - –ò—Å—Ç–æ—Ä–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
- `POST /api/flariki/award` - –ù–∞—á–∏—Å–ª–∏—Ç—å —Ñ–ª–∞—Ä–∏–∫–∏ (MANAGER/ADMIN)

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `initData` –æ—Ç Telegram WebApp
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏ —á–µ—Ä–µ–∑ Telegram Bot API (TODO: —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å)

### –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏
- **–ü—è—Ç–Ω–∏—Ü–∞ 10:00** - –û—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π –æ–± –æ—Ç—á–µ—Ç–∞—Ö
- **–í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ 02:00** - –ü–∞—Ä—Å–∏–Ω–≥ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Å–æ—Ü—Å–µ—Ç–µ–π

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Google Sheets
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –æ—Ç—á–µ—Ç–∞
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ—Å–ª–µ –ø–∞—Ä—Å–∏–Ω–≥–∞

### –ü–∞—Ä—Å–µ—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ YouTube, Instagram, TikTok
- –¢—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ API –∫–ª—é—á–µ–π –¥–ª—è –∫–∞–∂–¥–æ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã

## TODO / –£–ª—É—á—à–µ–Ω–∏—è

- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –ø–æ–¥–ø–∏—Å–∏ initData –æ—Ç Telegram
- [ ] –î–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å YouTube Data API
- [ ] –î–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å Instagram Graph API
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∑–∞–≥—Ä—É–∑–∫—É –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –¥–ª—è —Å–∫—Ä–∏–Ω—à–æ—Ç–æ–≤
- [ ] –î–æ–±–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- [ ] –°–æ–∑–¥–∞—Ç—å –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –¥–ª—è –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤
- [ ] –î–æ–±–∞–≤–∏—Ç—å —ç–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –≤ —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º—É —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT

