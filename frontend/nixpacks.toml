[phases.setup]
nixPkgs = ["nodejs_18", "npm-9_x", "openssl"]

[phases.install]
# Устанавливаем зависимости из корня проекта для работы с workspaces
# Railway клонирует весь репозиторий, поэтому можем перейти в корень
cmds = ["cd $RAILWAY_SOURCE_DIR && npm install --workspaces"]

[phases.build]
# Собираем фронтенд из его директории
cmds = ["cd frontend && npm run build"]

[start]
# Запускаем сервер из директории frontend
cmd = "cd frontend && npx serve -s dist -l $PORT"

