# üêõ –û—Ç–ª–∞–¥–∫–∞ –ø—Ä–æ–±–ª–µ–º –≤ Telegram

## –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –≤ Telegram

### –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:

1. ‚úÖ –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –Ω–∞—Ç–∏–≤–Ω—ã–π Telegram WebApp API –≤–º–µ—Å—Ç–æ SDK
2. ‚úÖ –£–ª—É—á—à–µ–Ω –ø–∞—Ä—Å–∏–Ω–≥ initData
3. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
4. ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω CORS –¥–ª—è cloudflare –¥–æ–º–µ–Ω–æ–≤

## –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É:

### 1. –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –≤ Telegram

–í Telegram Mini App –Ω–µ–ª—å–∑—è –æ—Ç–∫—Ä—ã—Ç—å DevTools –Ω–∞–ø—Ä—è–º—É—é, –Ω–æ –º–æ–∂–Ω–æ:

**–í–∞—Ä–∏–∞–Ω—Ç 1: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Telegram Desktop**
- –û—Ç–∫—Ä–æ–π—Ç–µ Telegram Desktop
- –û—Ç–∫—Ä–æ–π—Ç–µ Mini App
- –ù–∞–∂–º–∏—Ç–µ F12 –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è DevTools

**–í–∞—Ä–∏–∞–Ω—Ç 2: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ª–æ–≥–∏ –≤ –∫–æ–¥–µ**
- –í—Å–µ –≤–∞–∂–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ backend: `tail -f /tmp/backend.log`

### 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏

```bash
# Backend –ª–æ–≥–∏
tail -f /tmp/backend.log

# Frontend –ª–æ–≥–∏ (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã)
tail -f /tmp/frontend.log
```

### 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ API –∑–∞–ø—Ä–æ—Å—ã

–í –ª–æ–≥–∞—Ö backend –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–∞–ø—Ä–æ—Å—ã —Å –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏:
- `X-Telegram-Id`: ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è Telegram
- `X-Telegram-Init-Data`: initData –æ—Ç Telegram

## –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:

### –ü—Ä–æ–±–ª–µ–º–∞: "User not found"

**–†–µ—à–µ–Ω–∏–µ**: Backend –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—Ä–æ—Å–µ –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏.

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ backend - –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ:
```
Creating dev user with telegramId: <ID>
```

### –ü—Ä–æ–±–ª–µ–º–∞: API –∑–∞–ø—Ä–æ—Å—ã –Ω–µ –ø—Ä–æ—Ö–æ–¥—è—Ç

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ**:
1. Backend –∑–∞–ø—É—â–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É 3000
2. CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ
3. –ó–∞–≥–æ–ª–æ–≤–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ

### –ü—Ä–æ–±–ª–µ–º–∞: initData –Ω–µ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ –∫–æ–Ω—Å–æ–ª–∏**:
```javascript
window.Telegram.WebApp.initData
window.Telegram.WebApp.initDataUnsafe.user
```

–î–æ–ª–∂–Ω—ã –±—ã—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

## –û—Ç–ª–∞–¥–∫–∞ –≤ –∫–æ–¥–µ:

–î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤:
- `frontend/src/lib/telegram.ts` - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è WebApp
- `frontend/src/lib/api.ts` - API –∑–∞–ø—Ä–æ—Å—ã
- `frontend/src/store/auth.ts` - –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

–í—Å–µ –ª–æ–≥–∏ –≤—ã–≤–æ–¥—è—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞.

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã:

1. –û—Ç–∫—Ä–æ–π—Ç–µ Mini App –≤ Telegram
2. –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å (–µ—Å–ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ)
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:
   - "Telegram WebApp –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω" - –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å
   - "Initializing auth, Telegram user:" - –¥–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - "API Request:" - –¥–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã —Å telegramId

## –ï—Å–ª–∏ –≤—Å–µ –µ—â–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ backend –¥–æ—Å—Ç—É–ø–µ–Ω –∏–∑ Telegram
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ backend –Ω–∞ –æ—à–∏–±–∫–∏
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–µ—Ç—Å—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ initData –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ

